<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Dashboard - CyberServe</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <i class="fas fa-globe"></i>
                <span>CyberServe</span>
            </div>
            <ul class="nav-menu">
                <li class="nav-item"><a href="index.html" class="nav-link">Home</a></li>
                <li class="nav-item"><a href="service_request.html" class="nav-link">New Request</a></li>
                <li class="nav-item"><a href="#myRequests" class="nav-link">My Requests</a></li>
                <li class="nav-item"><a href="logout.html" class="nav-link">Logout</a></li>
            </ul>
            <div class="hamburger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </nav>

    <!-- Dashboard Header -->
    <div class="dashboard-header">
        <div class="dashboard-container">
            <h1>Welcome, <span id="userName">User</span>!</h1>
            <p>Your User ID: <strong id="userId">U1001</strong></p>
        </div>
    </div>

    <!-- Dashboard Content -->
    <div class="dashboard-container">
        <div class="dashboard-grid">
            <!-- User Profile Card -->
            <div class="dashboard-card">
                <h3><i class="fas fa-user"></i> Your Profile</h3>
                <div style="margin-top: 1rem;">
                    <p><strong>Name:</strong> <span id="profileName">-</span></p>
                    <p><strong>Email:</strong> <span id="profileEmail">-</span></p>
                    <p><strong>Mobile:</strong> <span id="profileMobile">-</span></p>
                    <p><strong>Address:</strong> <span id="profileAddress">-</span></p>
                </div>
            </div>

            <!-- Admin Details Card -->
            <div class="dashboard-card">
                <h3><i class="fas fa-building"></i> Admin Details</h3>
                <div style="margin-top: 1rem;">
                    <p><strong>Name:</strong> <span id="adminName">Abhishek Kr Pandey</span></p>
                    <p><strong>Mobile:</strong> <span id="adminMobile">+917209793495</span></p>
                    <p><strong>Email:</strong> <span id="adminEmail">admin@cyberserve.com</span></p>
                    <p><strong>Address:</strong> <span id="adminAddress">Obra Aurangabad (Bihar)</span></p>
                    <p><strong>Timing:</strong> <span id="adminTiming">9:00 AM - 9:00 PM</span></p>
                </div>
            </div>

            <!-- Quick Actions Card -->
            <div class="dashboard-card">
                <h3><i class="fas fa-bolt"></i> Quick Actions</h3>
                <div style="margin-top: 1rem;">
                    <a href="service_request.html" class="btn btn-primary" style="display: block; text-align: center; margin-bottom: 0.5rem;">
                        <i class="fas fa-plus"></i> New Service Request
                    </a>
                    <a href="#myRequests" class="btn btn-secondary" style="display: block; text-align: center;">
                        <i class="fas fa-list"></i> View My Requests
                    </a>
                </div>
            </div>
        </div>

        <!-- My Requests Section -->
        <div style="margin-top: 3rem;">
            <h2 id="myRequests" style="margin-bottom: 1.5rem;">My Service Requests</h2>
            <div id="requestsList" style="display: grid; gap: 1.5rem;">
                <p style="text-align: center; color: #999;">No requests yet. <a href="service_request.html" style="color: #667eea;">Create one now</a></p>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <p>&copy; 2024 CyberServe. All rights reserved.</p>
    </footer>

    <script src="script.js"></script>
    <script>
        function loadUserDashboard() {
            const currentUser = JSON.parse(localStorage.getItem('currentUser'));
            
            if (!currentUser) {
                window.location.href = 'user_login.html';
                return;
            }

            // Load user profile
            document.getElementById('userName').textContent = currentUser.name;
            document.getElementById('userId').textContent = currentUser.userId;
            document.getElementById('profileName').textContent = currentUser.name;
            document.getElementById('profileEmail').textContent = currentUser.email;
            document.getElementById('profileMobile').textContent = currentUser.mobile;
            document.getElementById('profileAddress').textContent = currentUser.address;

            // Load admin details
            const admins = JSON.parse(localStorage.getItem('cyberserve_admins')) || [];
            if (admins.length > 0) {
                const admin = admins[0];
                document.getElementById('adminName').textContent = admin.name;
                document.getElementById('adminMobile').textContent = admin.mobile;
                document.getElementById('adminEmail').textContent = admin.email;
                document.getElementById('adminAddress').textContent = admin.address;
                document.getElementById('adminTiming').textContent = admin.centerTiming;
            }

            // Load user requests
            loadUserRequests(currentUser.userId);
        }

        function loadUserRequests(userId) {
            const allRequests = JSON.parse(localStorage.getItem('cyberserve_requests')) || [];
            const userRequests = allRequests.filter(r => r.userId === userId);

            const requestsList = document.getElementById('requestsList');
            
            if (userRequests.length === 0) {
                requestsList.innerHTML = '<p style="text-align: center; color: #999;">No requests yet. <a href="service_request.html" style="color: #667eea;">Create one now</a></p>';
                return;
            }

            requestsList.innerHTML = userRequests.map(request => `
                <div class="request-item">
                    <div style="display: flex; justify-content: space-between; align-items: start;">
                        <div>
                            <h4>Request ID: ${request.requestId}</h4>
                            <p><strong>Services:</strong> ${request.services.join(', ')}</p>
                            <p><strong>Total Amount:</strong> â‚¹${request.totalAmount}</p>
                            <p><strong>Payment Reference:</strong> ${request.paymentReference || 'Pending'}</p>
                            <p><strong>Submitted:</strong> ${new Date(request.createdAt).toLocaleDateString()}</p>
                        </div>
                        <span class="request-status status-${request.status.toLowerCase()}">${request.status}</span>
                    </div>
                </div>
            `).join('');
        }

        window.addEventListener('load', loadUserDashboard);
    </script>
</body>
</html>

